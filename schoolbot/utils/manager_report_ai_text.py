import re

def extract_course_stats(report_text: str) -> str:
    """
    ฺฏุฒุงุฑุด ูุชู ูุฏุฑุณู ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู ู ุงุฒ ูุฑ ุฏูุฑูุ ุนููุงู ู ุจุฎุด ุขูุงุฑ ุฏุฑูุณ ุฑุง ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏ.
    ุฎุฑูุฌ ููุง ฺฉ ุฑุดุชู ุชฺฉโุฎุท ุจุฏูู ูุงุตููโูุง ุงุถุงูู ู ฺฉุงุฑุงฺฉุชุฑูุง 'โ' ุงุณุช.

    Args:
        report_text (str): ุฑุดุชู ฺฉุงูู ฺฏุฒุงุฑุด ูุฏุฑุณู.

    Returns:
        str: ฺฉ ุฑุดุชู ูุฑูุชโุจูุฏ ุดุฏูุ ุชฺฉโุฎุท ู ฺฉุงููุง ุชูุฒ ุดุฏู.
    """
    # ุจุฎุด ููุงุณู ุฑุง ุงุฒ ุงุจุชุฏุง ฺฉุงุฑ ุญุฐู ูโฺฉูู
    stop_marker = "๐ ููุงุณู ุฏูุฑูโูุง:"
    if stop_marker in report_text:
        report_text = report_text.split(stop_marker)[0]

    # ูุชู ุฑุง ุจุฑ ุงุณุงุณ ุฌุฏุงฺฉููุฏู "๐ ุฏูุฑู:" ุจู ุจุฎุดโูุง ูุฎุชูู ุชูุณู ูโฺฉูู
    sections = report_text.split("๐ ุฏูุฑู:")[1:]

    final_output_list = []

    # ุฑู ูุฑ ุจุฎุด ุญููู ูโุฒูู ุชุง ุงุทูุงุนุงุช ููุฑุฏ ูุธุฑ ุฑุง ุงุณุชุฎุฑุงุฌ ฺฉูู
    for section in sections:
        if "๐ ุขูุงุฑ ูุฑ ุฏุฑุณ:" in section:
            period_title = section.split('\n')[0].strip()
            stats_block = section.split("๐ ุขูุงุฑ ูุฑ ุฏุฑุณ:")[1]

            extracted_part = (
                f"๐ ุฏูุฑู: {period_title}\n"
                f"๐ ุขูุงุฑ ูุฑ ุฏุฑุณ:{stats_block.rstrip()}"
            )
            final_output_list.append(extracted_part)

    # --- ุชุบุฑ ููุง ุงูุฌุงุณุช ---
    # 1. ุชูุงู ุจุฎุดโูุง ุฑุง ุจู ฺฉ ุฑุดุชู ูุงุญุฏ ุชุจุฏู ูโฺฉูู
    combined_text = " ".join(final_output_list)

    # 2. ฺฉุงุฑุงฺฉุชุฑูุง 'โ' ุฑุง ุญุฐู ูโฺฉูู (ุจุง ุฌุงฺฏุฒู ุจุง ูฺ)
    text_without_lines = combined_text.replace('โ', '')

    # 3. ุญุงูุง ุชูุงู ูุถุงูุง ุฎุงู ุงุถุงูู (ูุงุตููุ ุฎุท ุฌุฏุฏ ู...) ุฑุง ุจู ฺฉ ูุงุตูู ุชุจุฏู ูโฺฉูู
    cleaned_text = re.sub(r'\s+', ' ', text_without_lines).strip()

    return cleaned_text